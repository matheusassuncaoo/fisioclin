<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Sistema de Gestão para Clínica de Fisioterapia" />
    <title>FisioClin - Sistema de Gestão</title>

    <!-- Styles -->
    <link rel="stylesheet" href="Assets/css/global.css" />
    <link rel="stylesheet" href="Assets/css/styles.css" />
    <link rel="stylesheet" href="Assets/css/responsive.css" />

    <!-- Icons -->
    <script src="https://unpkg.com/feather-icons"></script>

    <!-- Charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  </head>
  <body>
    <div class="app-container">
      <!-- Sidebar: Menu de Navegação -->
      <aside class="sidebar">
        <div class="brand">
          <i data-feather="activity"></i>
          <span>FisioClin</span>
        </div>

        <nav class="nav-menu">
          <a href="#" class="nav-item active" data-page="pacientes">
            <i data-feather="users"></i>
            <span>Pacientes</span>
          </a>
          <a href="#" class="nav-item" data-page="anamnese">
            <i data-feather="clipboard"></i>
            <span>Anamnese</span>
          </a>
          <a href="#" class="nav-item" data-page="procedimentos">
            <i data-feather="briefcase"></i>
            <span>Procedimentos</span>
          </a>
          <a href="#" class="nav-item" data-page="relatorios">
            <i data-feather="bar-chart-2"></i>
            <span>Relatórios</span>
          </a>
          <a href="#" class="nav-item" data-page="configuracoes">
            <i data-feather="settings"></i>
            <span>Configurações</span>
          </a>
        </nav>

        <div class="sidebar-footer">
          <div class="user-info">
            <i data-feather="user"></i>
            <div>
              <div class="user-name">Admin</div>
              <div class="user-role">Administrador</div>
            </div>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="loading-overlay hidden">
          <div class="spinner"></div>
        </div>

        <!-- PAGE: Pacientes -->
        <div id="pagePacientes" class="page">
          <!-- Header da Página -->
          <div class="page-header">
            <div>
              <h1>Gerenciamento de Pacientes</h1>
              <p class="subtitle">Busque, visualize e gerencie atendimentos</p>
            </div>
            <button class="btn btn-primary" id="btnNovoPaciente">
              <i data-feather="user-plus"></i> Novo Paciente
            </button>
          </div>

          <!-- Barra de Busca e Filtros -->
          <div class="search-bar">
            <div class="search-input-wrapper">
              <i data-feather="search"></i>
              <input type="text" id="searchPaciente" placeholder="Buscar por nome, RG ou ID..." />
            </div>
            <div class="filters">
              <select id="filterStatus">
                <option value="">Todos os status</option>
                <option value="true" selected>Ativos</option>
                <option value="false">Inativos</option>
              </select>
            </div>
          </div>

          <!-- Tabela de Pacientes -->
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Nome</th>
                  <th>RG</th>
                  <th>Estado RG</th>
                  <th>Status</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody id="pacientesTableBody">
                <tr class="loading-row">
                  <td colspan="6" style="text-align: center; padding: 2rem;">
                    <div class="spinner" style="margin: 0 auto;"></div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- PAGE: Anamnese -->
        <div id="pageAnamnese" class="page hidden">
          <div class="page-header">
            <div>
              <h1>Anamnese</h1>
              <p class="subtitle">Visualize e analise anamneses dos pacientes</p>
            </div>
            <button class="btn btn-primary" id="btnNovaAnamnese">
              <i data-feather="plus"></i> Nova Anamnese
            </button>
          </div>

          <!-- Filtros -->
          <div class="search-bar mb-3">
            <div class="search-input-wrapper">
              <i data-feather="search"></i>
              <input type="text" id="searchAnamnese" placeholder="Buscar paciente..." />
            </div>
            <div class="filters">
              <select id="filterStatusAnamnese">
                <option value="">Todos os status</option>
                <option value="ABERTA" selected>Abertas</option>
                <option value="CONCLUIDA">Concluídas</option>
                <option value="CANCELADA">Canceladas</option>
              </select>
            </div>
          </div>

          <!-- Gráficos de Dashboard -->
          <div class="charts-row mb-3" style="display: grid; grid-template-columns: 2fr 1fr; gap: 1.5rem;">
            <div class="chart-container">
              <h4>Atendimentos por Mês</h4>
              <canvas id="chartAtendimentosMes" style="height: 300px;"></canvas>
            </div>
            <div class="chart-container">
              <h4>Status das Anamneses</h4>
              <canvas id="chartStatusAnamnese" style="height: 300px;"></canvas>
            </div>
          </div>

          <!-- Lista de Anamneses -->
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Paciente</th>
                  <th>Data</th>
                  <th>Profissional</th>
                  <th>Status</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody id="anamneseTableBody">
                <tr>
                  <td colspan="6" class="text-center">Carregando...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- PAGE: Procedimentos (placeholder) -->
        <div id="pageProcedimentos" class="page hidden">
          <div class="page-header">
            <h1>Procedimentos</h1>
          </div>
          <div class="empty-state">
            <i data-feather="briefcase"></i>
            <h2>Em desenvolvimento</h2>
            <p>Módulo de procedimentos será implementado em breve</p>
          </div>
        </div>

        <!-- PAGE: Relatórios (placeholder) -->
        <div id="pageRelatorios" class="page hidden">
          <div class="page-header">
            <h1>Relatórios</h1>
          </div>
          <div class="empty-state">
            <i data-feather="bar-chart-2"></i>
            <h2>Em desenvolvimento</h2>
            <p>Módulo de relatórios será implementado em breve</p>
          </div>
        </div>

        <!-- PAGE: Configurações (placeholder) -->
        <div id="pageConfiguracoes" class="page hidden">
          <div class="page-header">
            <h1>Configurações</h1>
          </div>
          <div class="empty-state">
            <i data-feather="settings"></i>
            <h2>Em desenvolvimento</h2>
            <p>Módulo de configurações será implementado em breve</p>
          </div>
        </div>
      </main>
    </div>

    <!-- Modal: Atendimento SOAP -->
    <div id="modalAtendimento" class="modal hidden">
      <div class="modal-overlay" id="modalOverlay"></div>
      <div class="modal-content modal-lg">
        <div class="modal-header">
          <h2 id="modalTitle">Atendimento - Paciente</h2>
          <button class="btn-icon" id="btnCloseModal">
            <i data-feather="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <!-- Tabs -->
          <div class="tabs">
            <button class="tab-btn active" data-tab="nova-evolucao">Nova Evolução</button>
            <button class="tab-btn" data-tab="historico">Histórico</button>
            <button class="tab-btn" data-tab="info">Informações</button>
          </div>

          <!-- Tab Content: Nova Evolução -->
          <div id="tabNovaEvolucao" class="tab-content active">
            <form id="evolutionForm">
              <div class="form-grid">
                <div class="field">
                  <label>Data</label>
                  <input type="date" id="inputDate" required />
                </div>
                <div class="field">
                  <label>Profissional (ID)</label>
                  <input type="number" id="inputProf" placeholder="ID" required />
                </div>
                <div class="field">
                  <label>Procedimento (ID)</label>
                  <input type="number" id="inputProc" placeholder="ID" required />
                </div>
              </div>

              <div class="soap-inputs">
                <div class="soap-field">
                  <label class="s-label" title="Subjetivo">S</label>
                  <textarea id="inputS" placeholder="Subjetivo: Queixa do paciente, como se sente hoje..."></textarea>
                </div>
                <div class="soap-field">
                  <label class="o-label" title="Objetivo">O</label>
                  <textarea id="inputO" placeholder="Objetivo: Conduta realizada, exercícios, aparelhos..."></textarea>
                </div>
                <div class="soap-field">
                  <label class="a-label" title="Avaliação">A</label>
                  <textarea id="inputA" placeholder="Avaliação: Resposta ao tratamento, melhora/piora..."></textarea>
                </div>
                <div class="soap-field">
                  <label class="p-label" title="Plano">P</label>
                  <textarea id="inputP" placeholder="Plano: Conduta para próxima sessão..."></textarea>
                </div>
              </div>

              <button type="submit" class="btn btn-primary btn-block btn-lg">
                <i data-feather="save"></i> Salvar Evolução
              </button>
            </form>
          </div>

          <!-- Tab Content: Histórico -->
          <div id="tabHistorico" class="tab-content">
            <div id="historicoList" class="historico-list">
              <p>Carregando histórico...</p>
            </div>
          </div>

          <!-- Tab Content: Informações -->
          <div id="tabInfo" class="tab-content">
            <!-- Estatísticas -->
            <div class="stats-grid mb-3">
              <div class="stat-card">
                <i data-feather="activity"></i>
                <div class="stat-value" id="statTotalAtend">-</div>
                <div class="stat-label">Total Atendimentos</div>
              </div>
              <div class="stat-card">
                <i data-feather="calendar"></i>
                <div class="stat-value" id="statDiasTrat">-</div>
                <div class="stat-label">Dias em Tratamento</div>
              </div>
              <div class="stat-card">
                <i data-feather="trending-up"></i>
                <div class="stat-value" id="statFreqSemanal">-</div>
                <div class="stat-label">Freq. Semanal</div>
              </div>
              <div class="stat-card">
                <i data-feather="file-text"></i>
                <div class="stat-value" id="statTotalPront">-</div>
                <div class="stat-label">Prontuários</div>
              </div>
            </div>

            <!-- Gráfico de Evolução -->
            <div class="chart-container mb-3">
              <h4>Evolução dos Últimos 30 Dias</h4>
              <canvas id="chartEvolucao"></canvas>
            </div>

            <!-- Última Anamnese -->
            <div id="ultimaAnamneseCard" class="info-card mb-3">
              <h4><i data-feather="clipboard"></i> Última Anamnese</h4>
              <div id="ultimaAnamneseContent">
                <p>Nenhuma anamnese registrada</p>
              </div>
            </div>

            <!-- Dados Básicos -->
            <div id="pacienteInfo" class="info-grid">
              <p>Carregando informações...</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="Assets/js/apiManager.js"></script>
    <script src="Assets/js/charts.js"></script>
    <script src="Assets/js/pacienteDetalhes.js"></script>
    <script src="Assets/js/indexManager.js"></script>
    <script>
      feather.replace();
    </script>
  </body>
</html>
